<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Poker My Mind – Preflop Trainer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #05070d;
      --bg-alt: #090d18;
      --surface: #101522;
      --surface-soft: #141a28;
      --surface-softer: #181f30;
      --border-subtle: rgba(255, 255, 255, 0.06);
      --text-main: #e5ecff;
      --text-muted: #8d97b9;
      --accent: #35d9b3;
      --accent-soft: rgba(53, 217, 179, 0.18);
      --accent-strong: #46f0c8;
      --accent-blue: #4bd0ff;
      --danger: #ff4c6a;
      --danger-soft: rgba(255, 76, 106, 0.16);
      --good: #7df57a;
      --bad: #ff6b6b;
      --card-bg: #151b2a;
      --radius-lg: 18px;
      --radius-pill: 999px;
      --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.7);
      --shadow-subtle: 0 10px 30px rgba(0, 0, 0, 0.5);
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      color: var(--text-main);
      background: radial-gradient(circle at top, #151b33 0, #060713 55%, #020309 100%);
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .app-shell {
      width: 100%;
      max-width: 1240px;
      margin: 24px auto;
      padding: 18px 24px 28px;
      border-radius: 28px;
      background: radial-gradient(circle at top left, #1b2237 0, #050712 60%);
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(255, 255, 255, 0.06);
      backdrop-filter: blur(18px);
    }

    /* Header / nav */

    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 18px;
      gap: 18px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .brand-logo {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #4bd0ff, #0a121f 60%);
      box-shadow: 0 0 0 2px rgba(75, 208, 255, 0.65),
        0 0 30px rgba(75, 208, 255, 0.55);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      letter-spacing: 0.08em;
      font-size: 15px;
    }

    .brand-text h1 {
      margin: 0;
      font-size: 19px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #f4f7ff;
    }

    .brand-text p {
      margin: 2px 0 0;
      font-size: 12px;
      color: var(--text-muted);
    }

    .nav {
      display: inline-flex;
      padding: 2px;
      border-radius: 999px;
      background: rgba(8, 13, 26, 0.85);
      box-shadow: 0 0 0 1px rgba(133, 149, 195, 0.32);
    }

    .nav button {
      position: relative;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 13px;
      padding: 8px 18px;
      border-radius: 999px;
      cursor: pointer;
      transition: color 0.16s ease, background 0.16s ease,
        box-shadow 0.16s ease, transform 0.05s ease;
      white-space: nowrap;
    }

    .nav button:hover {
      color: #f3f7ff;
    }

    .nav button.active {
      background: radial-gradient(circle at top, var(--accent-blue), var(--accent));
      color: #03050a;
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.2),
        0 0 26px rgba(75, 208, 255, 0.75);
      font-weight: 600;
    }

    .nav button:active {
      transform: scale(0.97);
    }

    /* Tabs */

    .tab-panel {
      margin-top: 10px;
    }

    #tab-potodds,
    #tab-about {
      display: none;
    }

    /* Preflop layout */

    .preflop-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 10px;
      margin-bottom: 12px;
    }

    .preflop-header-title {
      font-size: 22px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .preflop-header-sub {
      font-size: 12px;
      color: var(--text-muted);
    }

    .preflop-scenario-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 16px;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(19, 26, 46, 0.9), rgba(10, 14, 30, 0.9));
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: var(--shadow-subtle);
      margin-bottom: 14px;
      gap: 12px;
    }

    #scenarioPosition {
      font-size: 13px;
      color: var(--text-muted);
    }

    #scenarioPosition strong {
      color: #f5f7ff;
      letter-spacing: 0.03em;
    }

    .auto-toggle-label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .pill-toggle {
      min-width: 48px;
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: radial-gradient(circle at 30% 0, #182337, #090f1c);
      color: var(--accent-blue);
      font-size: 11px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      cursor: pointer;
      transition: background 0.16s ease, box-shadow 0.16s ease, color 0.16s ease;
    }

    .pill-toggle.active {
      background: radial-gradient(circle at 30% 0, var(--accent-blue), var(--accent));
      color: #02040a;
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.3),
        0 0 20px rgba(75, 208, 255, 0.9);
      font-weight: 600;
    }

    .preflop-main-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.05fr) minmax(0, 1fr);
      gap: 16px;
      margin-bottom: 16px;
    }

    .panel {
      background: radial-gradient(circle at top, #182133 0, #101625 55%, #080b15 100%);
      border-radius: var(--radius-lg);
      padding: 14px 16px 16px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: var(--shadow-subtle);
    }

    .panel-header {
      font-size: 13px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    /* Cards */

    .cards-shell {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .card-row {
      display: flex;
      gap: 10px;
    }

    .card {
      flex: 1;
      min-width: 0;
      aspect-ratio: 5 / 7;
      border-radius: 18px;
      background: radial-gradient(circle at 30% 0, #242f45, #0a0f1c 70%);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 16px 30px rgba(0, 0, 0, 0.75);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 20% 0, rgba(255, 255, 255, 0.08), transparent 55%);
      opacity: 0.9;
    }

    .card-inner {
      position: relative;
      z-index: 1;
      text-align: center;
    }

    .card-rank {
      display: block;
      font-size: 34px;
      font-weight: 700;
      letter-spacing: 0.06em;
    }

    .card-suit {
      display: block;
      margin-top: 4px;
      font-size: 20px;
    }

    .card-suit.red {
      color: #ff6f8a;
    }

    .hand-preview {
      font-size: 13px;
      color: var(--text-muted);
    }

    .hand-preview strong {
      color: #f7fbff;
      font-weight: 600;
    }

    /* Position map */

    .position-map-shell {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .position-ring {
      width: 190px;
      height: 190px;
      border-radius: 50%;
      margin: 0 auto;
      position: relative;
      border: 1px dashed rgba(255, 255, 255, 0.14);
      background: radial-gradient(circle at center, #151d30, #050712 70%);
      box-shadow: inset 0 0 25px rgba(0, 0, 0, 0.8);
    }

    .position-seat {
      position: absolute;
      width: 54px;
      height: 26px;
      border-radius: 999px;
      font-size: 11px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      background: rgba(6, 10, 22, 0.95);
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.4);
    }

    .position-seat.active {
      color: #020307;
      background: radial-gradient(circle at top, var(--accent), var(--accent-blue));
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.6),
        0 0 26px rgba(93, 233, 204, 0.9);
      font-weight: 600;
    }

    .position-seat[data-pos="UTG"] {
      top: 6px;
      left: 50%;
      transform: translateX(-50%);
    }

    .position-seat[data-pos="MP"] {
      top: 50%;
      right: 2px;
      transform: translateY(-50%);
    }

    .position-seat[data-pos="CO"] {
      bottom: 10px;
      right: 26px;
    }

    .position-seat[data-pos="BTN"] {
      bottom: 10px;
      left: 26px;
    }

    .position-seat[data-pos="SB"] {
      top: 50%;
      left: 2px;
      transform: translateY(-50%);
    }

    .position-seat[data-pos="BB"] {
      top: 6px;
      right: 50%;
      transform: translateX(50%);
    }

    .position-note {
      font-size: 12px;
      color: var(--text-muted);
      text-align: center;
      padding: 6px 8px 0;
    }

    /* Actions row */

    .preflop-actions-panel {
      background: radial-gradient(circle at top, #192238, #0e1423 65%);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(255, 255, 255, 0.08);
      padding: 10px 14px 12px;
      margin-bottom: 10px;
      box-shadow: var(--shadow-subtle);
    }

    .preflop-actions-header {
      font-size: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    .actions-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .action-btn {
      flex: 1;
      min-width: 110px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.12);
      padding: 8px 14px;
      font-size: 13px;
      background: linear-gradient(120deg, rgba(17, 24, 40, 0.98), rgba(8, 11, 22, 0.98));
      color: var(--text-muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: background 0.16s ease, color 0.16s ease, box-shadow 0.16s ease,
        transform 0.04s ease, border-color 0.16s ease;
    }

    .action-btn span {
      letter-spacing: 0.03em;
    }

    .action-btn:hover {
      color: #f7fbff;
      border-color: rgba(255, 255, 255, 0.3);
    }

    .action-btn.selected {
      background: radial-gradient(circle at top, var(--accent-blue), var(--accent));
      color: #020306;
      font-weight: 600;
      box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.6),
        0 0 24px rgba(89, 226, 199, 0.85);
    }

    .action-btn.disabled,
    .action-btn[aria-disabled="true"] {
      opacity: 0.25;
      cursor: default;
      box-shadow: none;
    }

    /* Primary button + auto-deal */

    .preflop-primary-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      margin-bottom: 14px;
    }

    .primary-btn {
      position: relative;
      flex: 1;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.18);
      padding: 0;
      height: 50px;
      background: radial-gradient(circle at top, #1d263a, #0b101f 70%);
      overflow: hidden;
      cursor: pointer;
      box-shadow: var(--shadow-subtle);
      transition: transform 0.05s ease, box-shadow 0.16s ease;
    }

    .primary-btn:active {
      transform: scale(0.98);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.7);
    }

    .primary-btn .primary-progress {
      position: absolute;
      inset: 0;
      width: 0%;
      background: linear-gradient(
        120deg,
        rgba(53, 217, 179, 0.55),
        rgba(75, 208, 255, 0.6)
      );
      box-shadow: 0 0 26px rgba(75, 208, 255, 0.7);
      opacity: 0.0;
      pointer-events: none;
      transition: width 0.04s linear, opacity 0.12s ease-out;
      z-index: 0;
    }

    .primary-btn.timer-active .primary-progress {
      opacity: 1;
    }

    .primary-btn .primary-content {
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      height: 100%;
      padding: 0 22px;
      font-size: 14px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: #f4f8ff;
    }

    .primary-btn .primary-icon-light {
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.35);
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.25), transparent);
      font-size: 11px;
    }

    /* Feedback + stats */

    .preflop-feedback-row {
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 0.9fr);
      gap: 16px;
    }

    .feedback-panel {
      background: radial-gradient(circle at top left, #161f35 0, #0a0f1d 55%);
      border-radius: var(--radius-lg);
      padding: 14px 16px 16px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: var(--shadow-subtle);
    }

    .feedback-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }

    .grade-badge {
      width: 36px;
      height: 36px;
      border-radius: 12px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.08em;
      border: 1px solid rgba(255, 255, 255, 0.18);
      background: radial-gradient(circle at 30% 0, #202b41, #080c16);
      color: var(--text-muted);
    }

    .grade-badge-good {
      background: radial-gradient(circle at 30% 0, #7df57a, #1d4123);
      color: #041002;
      box-shadow: 0 0 24px rgba(125, 245, 122, 0.65);
    }

    .grade-badge-bad {
      background: radial-gradient(circle at 30% 0, #ff6b6b, #4e1010);
      color: #fff8f6;
      box-shadow: 0 0 24px rgba(255, 107, 107, 0.6);
    }

    .grade-context {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      margin-bottom: 3px;
    }

    .grade-recommendation {
      font-size: 14px;
      font-weight: 600;
    }

    .feedback-body {
      font-size: 13px;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .stats-panel {
      background: radial-gradient(circle at top, #191f33 0, #0b101f 60%);
      border-radius: var(--radius-lg);
      padding: 14px 16px 16px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: var(--shadow-subtle);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .stats-panel h3 {
      margin: 0 0 6px;
      font-size: 13px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      font-size: 11px;
      color: var(--text-muted);
    }

    .chip {
      padding: 3px 8px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.14);
      background: rgba(7, 10, 24, 0.95);
    }

    .chip.good {
      border-color: rgba(125, 245, 122, 0.5);
      color: var(--good);
    }

    .chip.leaky {
      border-color: rgba(255, 107, 107, 0.55);
      color: var(--danger);
    }

    .overall-grade-row {
      margin-top: 2px;
      padding-top: 8px;
      border-top: 1px dashed rgba(255, 255, 255, 0.12);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .overall-grade-label {
      font-size: 12px;
      color: var(--text-muted);
    }

    .overall-grade-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      background: radial-gradient(circle at top, var(--accent-soft), #071017);
      border: 1px solid rgba(53, 217, 179, 0.5);
      font-size: 13px;
    }

    .overall-grade-letter {
      font-weight: 700;
      font-size: 16px;
    }

    .overall-grade-percent {
      font-size: 13px;
      color: var(--accent-strong);
    }

    .ghost-btn {
      margin-top: 4px;
      align-self: flex-start;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(255, 255, 255, 0.16);
      padding: 5px 12px;
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: rgba(4, 9, 18, 0.9);
      color: var(--text-muted);
      cursor: pointer;
      transition: background 0.16s ease, color 0.16s ease, box-shadow 0.16s ease;
    }

    .ghost-btn:hover {
      background: rgba(255, 255, 255, 0.08);
      color: #f4f7ff;
      box-shadow: 0 0 18px rgba(255, 255, 255, 0.15);
    }

    /* Pot odds tab */

    .pot-grid {
      display: grid;
      grid-template-columns: minmax(0, 0.9fr) minmax(0, 1.1fr);
      gap: 18px;
      margin-top: 10px;
    }

    .pot-panel {
      background: radial-gradient(circle at top, #151d30, #070b15 70%);
      border-radius: var(--radius-lg);
      padding: 14px 16px 16px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: var(--shadow-subtle);
    }

    .pot-panel h2 {
      margin: 0 0 8px;
      font-size: 16px;
    }

    .form-row {
      display: flex;
      gap: 10px;
      margin-bottom: 8px;
    }

    .form-field {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
    }

    .form-field label {
      color: var(--text-muted);
    }

    .form-field input {
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.16);
      background: rgba(3, 6, 14, 0.96);
      padding: 6px 9px;
      color: var(--text-main);
      font-size: 13px;
      outline: none;
    }

    .form-field input:focus {
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 1px rgba(75, 208, 255, 0.8);
    }

    .primary-sm {
      margin-top: 5px;
      border-radius: var(--radius-pill);
      border: none;
      padding: 7px 14px;
      font-size: 13px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: radial-gradient(circle at top, var(--accent-blue), var(--accent));
      color: #020307;
      cursor: pointer;
      box-shadow: 0 0 24px rgba(75, 208, 255, 0.75);
    }

    .primary-sm:active {
      transform: scale(0.97);
    }

    .pot-summary {
      font-size: 14px;
      margin-top: 6px;
    }

    .pot-expl {
      margin-top: 4px;
      font-size: 13px;
      color: var(--text-muted);
    }

    /* About tab */

    .about-panel {
      margin-top: 12px;
      background: radial-gradient(circle at top, #151d2d, #050712 70%);
      border-radius: var(--radius-lg);
      padding: 16px 18px 20px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow: var(--shadow-subtle);
      font-size: 13px;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .about-panel h2 {
      margin-top: 0;
      color: #f3f6ff;
      font-size: 17px;
    }

    /* Footer */

    .app-footer {
      margin-top: 18px;
      font-size: 11px;
      text-align: center;
      color: var(--text-muted);
      opacity: 0.8;
    }

    /* Responsive */

    @media (max-width: 900px) {
      .preflop-main-grid,
      .preflop-feedback-row,
      .pot-grid {
        grid-template-columns: minmax(0, 1fr);
      }
      .preflop-primary-row {
        flex-direction: column;
      }
      .nav {
        width: 100%;
        justify-content: center;
      }
    }

    @media (max-width: 640px) {
      .app-shell {
        margin: 0;
        border-radius: 0;
        box-shadow: none;
      }
      .app-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div class="brand">
        <div class="brand-logo">PM</div>
        <div class="brand-text">
          <h1>POKER MY MIND</h1>
          <p>Judge your decisions, not your luck.</p>
        </div>
      </div>

      <nav class="nav">
        <button class="active" data-tab="preflop">Preflop Trainer</button>
        <button data-tab="potodds">Pot Odds</button>
        <button data-tab="about">About</button>
      </nav>
    </header>

    <!-- PRE-FLOP TAB -->
    <main id="tab-preflop" class="tab-panel">
      <header class="preflop-header">
        <div>
          <div class="preflop-header-title">Preflop Trainer</div>
          <div class="preflop-header-sub">
            Drop into a random spot, choose your play, then see if it was +EV &mdash;
            before any flop.
          </div>
        </div>
      </header>

      <section class="preflop-scenario-bar">
        <div id="scenarioPosition">
          POS: <strong>BTN (Button)</strong>
        </div>
        <div class="auto-toggle-label">
          <span>AUTO DEAL IF A</span>
          <button
            id="autoDealToggle"
            class="pill-toggle active"
            type="button"
            aria-pressed="true"
          >
            On
          </button>
        </div>
      </section>

      <section class="preflop-main-grid">
        <!-- 3. Dealt cards -->
        <section class="panel cards-shell">
          <div class="panel-header">Dealt cards</div>
          <div class="card-row">
            <article class="card">
              <div class="card-inner">
                <span id="card1Rank" class="card-rank">A</span>
                <span id="card1Suit" class="card-suit">♠</span>
              </div>
            </article>
            <article class="card">
              <div class="card-inner">
                <span id="card2Rank" class="card-rank">K</span>
                <span id="card2Suit" class="card-suit">♠</span>
              </div>
            </article>
          </div>
          <div id="handPreview" class="hand-preview">
            Hand: <strong>AKs</strong>
          </div>
        </section>

        <!-- 4. Position info -->
        <section class="panel position-map-shell">
          <div class="panel-header">Your position</div>
          <div class="position-ring">
            <div class="position-seat" data-pos="UTG">UTG</div>
            <div class="position-seat" data-pos="MP">MP</div>
            <div class="position-seat" data-pos="CO">CO</div>
            <div class="position-seat active" data-pos="BTN">BTN</div>
            <div class="position-seat" data-pos="SB">SB</div>
            <div class="position-seat" data-pos="BB">BB</div>
          </div>
          <p id="positionNote" class="position-note">
            Button: best seat at the table. You act last postflop, so you can open the
            widest range.
          </p>
        </section>
      </section>

      <!-- 5. Actions -->
      <section class="preflop-actions-panel">
        <div class="preflop-actions-header">Your action</div>
        <div class="actions-row" id="actionButtons">
          <button class="action-btn" type="button" data-action="FOLD">
            <span>Fold</span>
          </button>
          <button
            class="action-btn"
            type="button"
            data-action="CHECK"
            id="checkBtn"
          >
            <span>Check</span>
          </button>
          <button
            class="action-btn"
            type="button"
            data-action="CALL"
            id="callBtn"
          >
            <span>Limp / Call</span>
          </button>
          <button class="action-btn" type="button" data-action="RAISE">
            <span>Open / Raise</span>
          </button>
        </div>
      </section>

      <!-- 6 & 7. Primary button + auto-deal timer -->
      <section class="preflop-primary-row">
        <button id="primaryBtn" class="primary-btn" type="button">
          <span id="autoDealBar" class="primary-progress"></span>
          <span class="primary-content">
            <span id="primaryLabel">Evaluate decision</span>
            <span id="primaryIcon" class="primary-icon-light">→</span>
          </span>
        </button>
      </section>

      <!-- 8 & 9. Feedback + stats -->
      <section class="preflop-feedback-row">
        <section class="feedback-panel">
          <header class="feedback-header">
            <span id="gradeLetter" class="grade-badge">–</span>
            <div>
              <div id="gradeContext" class="grade-context">Awaiting decision.</div>
              <div id="recommendation" class="grade-recommendation">
                Pick an action and evaluate to see feedback.
              </div>
            </div>
          </header>
          <div id="explanation" class="feedback-body">
            Lock in what you would actually do at the table, then hit “Evaluate decision”
            to see if the play is winning or leaking chips over time.
          </div>
        </section>

        <aside class="stats-panel">
          <h3>Session stats</h3>
          <div class="chip-row">
            <span id="statTotal" class="chip">Decisions: 0</span>
            <span id="statGood" class="chip good">Good (A/B): 0</span>
            <span id="statLeaky" class="chip leaky">Leaky (C–F): 0</span>
          </div>
          <div class="overall-grade-row">
            <div class="overall-grade-label">Overall grade</div>
            <div class="overall-grade-pill">
              <span id="reportGrade" class="overall-grade-letter">–</span>
              <span id="reportPercent" class="overall-grade-percent">0%</span>
            </div>
          </div>
          <button id="resetStatsBtn" type="button" class="ghost-btn">
            Reset stats
          </button>
        </aside>
      </section>
    </main>

    <!-- POT ODDS TAB -->
    <section id="tab-potodds" class="tab-panel">
      <div class="pot-grid">
        <div class="pot-panel">
          <h2>Pot Odds Helper</h2>
          <p class="preflop-header-sub">
            Plug in a pot, a bet you are facing, and your number of outs. The trainer
            will tell you whether calling is roughly +EV or if folding is safer.
          </p>
          <div class="form-row">
            <div class="form-field">
              <label for="potSize">Current pot size</label>
              <input id="potSize" type="number" min="0" step="0.01" value="40" />
            </div>
            <div class="form-field">
              <label for="betSize">Bet you are facing</label>
              <input id="betSize" type="number" min="0" step="0.01" value="20" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-field">
              <label for="outs">Number of outs</label>
              <input id="outs" type="number" min="0" step="1" value="9" />
            </div>
          </div>
          <button id="calculateOddsBtn" class="primary-sm" type="button">
            Calculate
          </button>
        </div>

        <div class="pot-panel">
          <h2>Result</h2>
          <div id="oddsSummary" class="pot-summary">–</div>
          <div id="oddsExplanation" class="pot-expl">
            Pot odds compare the price of a call to the chance your hand will improve.
            Enter the numbers on the left, then hit Calculate to see a plain-English
            verdict.
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT TAB -->
    <section id="tab-about" class="tab-panel">
      <section class="about-panel">
        <h2>What this trainer is (and isn’t)</h2>
        <p>
          <strong>Poker My Mind</strong> is a lightweight tool for training your gut
          decisions in common cash-game spots. You get dropped into a random preflop
          scenario, choose what you’d actually do, then see whether the play lines up
          with a simple strategy model.
        </p>
        <p>
          The goal isn’t to be a perfect solver. Instead, this trainer gives you:
        </p>
        <ul>
          <li>Clear letter grades and session stats.</li>
          <li>Short, jargon-free explanations of each spot.</li>
          <li>
            A sense of when you’re too tight, too loose, or leaking value with limps and
            calls.
          </li>
        </ul>
        <p>
          Always follow the rules of your cardroom, and never use this app as a real-time
          assistant while playing.
        </p>
      </section>
    </section>

    <footer class="app-footer">
      Poker My Mind &middot; Prototype trainer only. Not a real-time tool for any poker
      site or casino.
    </footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      /* ---------- Tabs ---------- */
      const tabs = document.querySelectorAll('.nav button');
      const sections = {
        preflop: document.getElementById('tab-preflop'),
        potodds: document.getElementById('tab-potodds'),
        about: document.getElementById('tab-about'),
      };

      tabs.forEach((btn) => {
        btn.addEventListener('click', () => {
          tabs.forEach((b) => b.classList.remove('active'));
          btn.classList.add('active');
          const tab = btn.dataset.tab;
          Object.entries(sections).forEach(([key, el]) => {
            el.style.display = key === tab ? 'block' : 'none';
          });
        });
      });

      /* ---------- Preflop logic ---------- */
      const rankOrder = ['A', 'K', 'Q', 'J', 'T', '9', '8', '7', '6', '5', '4', '3', '2'];
      const openRangesByPosition = {
        UTG: ['AA', 'KK', 'QQ', 'JJ', 'TT', '99', 'AKs', 'AQs', 'AJs', 'KQs', 'AKo', 'AQo'],
        MP: [
          'AA','KK','QQ','JJ','TT','99','88','77',
          'AKs','AQs','AJs','ATs','KQs','KJs','QJs',
          'AKo','AQo','KQo',
        ],
        CO: [
          'AA','KK','QQ','JJ','TT','99','88','77','66','55','44','33','22',
          'AKs','AQs','AJs','ATs','A9s','A8s',
          'KQs','KJs','KTs',
          'QJs','QTs','JTs','T9s','98s',
          'AKo','AQo','AJo','KQo','KJo','QJo',
        ],
        BTN: [
          'AA','KK','QQ','JJ','TT','99','88','77','66','55','44','33','22',
          'AKs','AQs','AJs','ATs','A9s','A8s','A7s','A6s','A5s','A4s','A3s','A2s',
          'KQs','KJs','KTs','K9s',
          'QJs','QTs','Q9s',
          'JTs','J9s',
          'T9s','T8s',
          '98s','97s','87s','76s','65s',
          'AKo','AQo','AJo','ATo','A9o',
          'KQo','KJo','KTo',
          'QJo','QTo',
          'JTo',
        ],
        SB: [
          'AA','KK','QQ','JJ','TT','99','88','77','66','55',
          'AKs','AQs','AJs','ATs','A9s','A8s',
          'KQs','KJs','KTs',
          'QJs','QTs','JTs','T9s','98s',
          'AKo','AQo','AJo','KQo','KJo','QJo',
        ],
        BB: [
          'AA','KK','QQ','JJ','TT','99','88','77',
          'AKs','AQs','AJs','ATs','KQs','KJs',
          'QJs','JTs','T9s',
          'AKo','AQo','AJo','KQo',
        ],
      };

      function canonicalHand(rank1, rank2, suitedFlag) {
        if (rank1 === rank2) return rank1 + rank2;
        const idx1 = rankOrder.indexOf(rank1);
        const idx2 = rankOrder.indexOf(rank2);
        const high = idx1 <= idx2 ? rank1 : rank2;
        const low = idx1 <= idx2 ? rank2 : rank1;
        return high + low + suitedFlag;
      }

      function evaluatePreflopOpen(position, hand, userAction) {
        const allowed = openRangesByPosition[position] || [];
        const isInOpenRange = allowed.includes(hand);

        // Big blind special handling
        if (position === 'BB') {
          if (userAction === 'CHECK') {
            if (isInOpenRange) {
              return {
                grade: 'B',
                good: true,
                context: 'Safe but passive.',
                recommended: 'Raising prints more value.',
                explanation:
                  'Checking a strong hand in the big blind is never horrible when you see a free flop, but raising builds a pot while you are ahead.',
              };
            }
            return {
              grade: 'A',
              good: true,
              context: 'Correct free check.',
              recommended: 'Checking is ideal.',
              explanation:
                'With a marginal hand in the big blind and no raise, taking the free check lets you see a flop without risking extra chips.',
            };
          }
          if (userAction === 'FOLD') {
            return {
              grade: 'D',
              good: false,
              context: 'Too tight.',
              recommended: 'Check instead of folding.',
              explanation:
                'Folding when you can check for free throws away your equity. Use the check option and take the free flop instead.',
            };
          }
          // For raises in BB, fall through to open-range logic
        }

        if (isInOpenRange) {
          if (userAction === 'RAISE') {
            return {
              grade: 'A',
              good: true,
              context: 'Solid open.',
              recommended: 'Raise / open this hand.',
              explanation:
                hand +
                ' sits inside your recommended open range from this position. Opening keeps you aggressive and makes money long term.',
            };
          }
          if (userAction === 'FOLD') {
            return {
              grade: 'F',
              good: false,
              context: 'Too tight.',
              recommended: 'Raise this hand instead of folding.',
              explanation:
                'Folding a hand that should be opened leaves chips on the table. You skip too many profitable spots.',
            };
          }
          if (userAction === 'CALL') {
            return {
              grade: 'C',
              good: false,
              context: 'Leaky limp.',
              recommended: 'Raise, don’t limp.',
              explanation:
                'Limping hands that belong in your open range is passive and hard to play. Raise instead to keep your range strong.',
            };
          }
        } else {
          if (userAction === 'RAISE') {
            return {
              grade: 'D',
              good: false,
              context: 'Too loose.',
              recommended: 'Fold this hand preflop.',
              explanation:
                'Opening a hand this weak from your position loses money over time. Stick to the stronger part of your range.',
            };
          }
          if (userAction === 'CALL') {
            return {
              grade: 'D',
              good: false,
              context: 'Weak limp.',
              recommended: 'Just fold this hand.',
              explanation:
                'Limping with weak holdings in unopened pots rarely ends well. Fold and wait for a better spot.',
            };
          }
          if (userAction === 'FOLD') {
            return {
              grade: 'A',
              good: true,
              context: 'Good discipline.',
              recommended: 'Folding is correct.',
              explanation:
                'Skipping marginal opens from early or awkward positions protects your bankroll and keeps your range clean.',
            };
          }
        }

        return {
          grade: 'B',
          good: true,
          context: 'Reasonable.',
          recommended: 'Borderline but acceptable.',
          explanation:
            'This one is close. Against tight tables, folding is fine; against weak players, opening may print money.',
        };
      }

      const positions = ['UTG', 'MP', 'CO', 'BTN', 'SB', 'BB'];
      const positionLabels = {
        UTG: '1. UTG (Early)',
        MP: '2. MP (Middle)',
        CO: '3. CO (Cutoff)',
        BTN: '4. BTN (Button)',
        SB: '5. SB (Small Blind)',
        BB: '6. BB (Big Blind)',
      };
      const positionDescriptions = {
        UTG: 'Early position: many players left to act. Play your tightest range here.',
        MP: 'Middle position: a bit safer than UTG, but still tighter than late seats.',
        CO: 'Cutoff: only the button behind you. Great spot to open and steal.',
        BTN: 'Button: best seat at the table. You act last postflop, so you can play the widest range.',
        SB: 'Small blind: you are out of position and already invested. Open tighter and avoid junk.',
        BB: 'Big blind: you close the action preflop and often get good pot odds to defend.',
      };

      const ranks = ['A', 'K', 'Q', 'J', 'T', '9', '8', '7', '6', '5', '4', '3', '2'];
      const suits = [
        { symbol: '♠', color: 'black' },
        { symbol: '♥', color: 'red' },
        { symbol: '♦', color: 'red' },
        { symbol: '♣', color: 'black' },
      ];

      const scenarioPositionEl = document.getElementById('scenarioPosition');
      const positionNoteEl = document.getElementById('positionNote');
      const positionSeatEls = document.querySelectorAll('.position-seat');

      const handPreviewTextEl = document.querySelector('#handPreview strong');
      const card1RankEl = document.getElementById('card1Rank');
      const card1SuitEl = document.getElementById('card1Suit');
      const card2RankEl = document.getElementById('card2Rank');
      const card2SuitEl = document.getElementById('card2Suit');

      const actionButtonsEl = document.getElementById('actionButtons');
      const callBtn = document.getElementById('callBtn');
      const checkBtn = document.getElementById('checkBtn');
      const primaryBtn = document.getElementById('primaryBtn');
      const primaryLabelEl = document.getElementById('primaryLabel');
      const primaryIconEl = document.getElementById('primaryIcon');
      const autoDealToggleBtn = document.getElementById('autoDealToggle');
      const autoDealBarEl = document.getElementById('autoDealBar');

      const gradeLetterEl = document.getElementById('gradeLetter');
      const gradeContextEl = document.getElementById('gradeContext');
      const recommendationEl = document.getElementById('recommendation');
      const explanationEl = document.getElementById('explanation');

      const statTotalEl = document.getElementById('statTotal');
      const statGoodEl = document.getElementById('statGood');
      const statLeakyEl = document.getElementById('statLeaky');
      const reportGradeEl = document.getElementById('reportGrade');
      const reportPercentEl = document.getElementById('reportPercent');
      const resetStatsBtn = document.getElementById('resetStatsBtn');

      let currentPosition = 'BTN';
      let currentCanonicalHand = 'AKs';
      let selectedAction = null;
      let hasEvaluatedCurrent = false;
      let autoDealEnabled = true;
      let awaitingDeal = false;
      let autoDealTimeoutId = null;
      let lastEvalGrade = null;

      function randomFrom(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
      }

      function setSelectedAction(action) {
        selectedAction = action;
        if (!actionButtonsEl) return;
        actionButtonsEl.querySelectorAll('.action-btn').forEach((btn) => {
          btn.classList.toggle('selected', btn.dataset.action === action);
        });
      }

      function updatePositionUI() {
        const label = positionLabels[currentPosition] || currentPosition;
        scenarioPositionEl.innerHTML = 'POS: <strong>' + label + '</strong>';
        positionNoteEl.textContent = positionDescriptions[currentPosition] || '';
        positionSeatEls.forEach((seat) => {
          const pos = seat.getAttribute('data-pos');
          seat.classList.toggle('active', pos === currentPosition);
        });
      }

      function updateActionsForPosition() {
        if (!callBtn || !checkBtn) return;
        const allBtns = actionButtonsEl.querySelectorAll('.action-btn');

        if (currentPosition === 'BB') {
          checkBtn.style.display = 'inline-flex';
          callBtn.classList.add('disabled');
          callBtn.setAttribute('aria-disabled', 'true');
          callBtn.title = 'In the big blind with no raise, you check instead of calling.';
        } else {
          checkBtn.style.display = 'none';
          callBtn.classList.remove('disabled');
          callBtn.removeAttribute('aria-disabled');
          callBtn.title =
            'Limping = calling the big blind preflop instead of raising. Usually weaker than raising.';
        }

        allBtns.forEach((btn) => {
          btn.classList.toggle('selected', btn.dataset.action === selectedAction);
        });
      }

      function setPrimaryToEvaluate() {
        primaryLabelEl.textContent = 'Evaluate decision';
        primaryIconEl.textContent = '→';
      }

      function setPrimaryToDeal() {
        primaryLabelEl.textContent = 'Deal new hand';
        primaryIconEl.textContent = '♠';
      }

      function clearAutoDealTimer() {
        if (autoDealTimeoutId !== null) {
          clearTimeout(autoDealTimeoutId);
          autoDealTimeoutId = null;
        }
        if (autoDealBarEl) {
          autoDealBarEl.style.width = '0%';
        }
        primaryBtn.classList.remove('timer-active');
      }

      function resetResultBox() {
        gradeLetterEl.textContent = '–';
        gradeLetterEl.classList.remove('grade-badge-good', 'grade-badge-bad');
        gradeContextEl.textContent = 'Awaiting decision.';
        recommendationEl.textContent = 'Pick an action and evaluate to see feedback.';
        explanationEl.textContent =
          'Lock in an action for this hand to get a recommendation and letter grade.';
      }

      function resetHandState() {
        hasEvaluatedCurrent = false;
        awaitingDeal = false;
        lastEvalGrade = null;
        clearAutoDealTimer();
        setPrimaryToEvaluate();
      }

      function dealScenario() {
        currentPosition = randomFrom(positions);
        updatePositionUI();

        // pick two distinct cards (no exact duplicates)
        const r1 = randomFrom(ranks);
        const s1 = randomFrom(suits);
        let r2 = randomFrom(ranks);
        let s2 = randomFrom(suits);
        while (r2 === r1 && s2.symbol === s1.symbol) {
          r2 = randomFrom(ranks);
          s2 = randomFrom(suits);
        }

        const suitedFlag = r1 === r2 ? '' : s1.symbol === s2.symbol ? 's' : 'o';
        currentCanonicalHand = canonicalHand(r1, r2, suitedFlag);

        card1RankEl.textContent = r1;
        card1SuitEl.textContent = s1.symbol;
        card1SuitEl.classList.toggle('red', s1.color === 'red');

        card2RankEl.textContent = r2;
        card2SuitEl.textContent = s2.symbol;
        card2SuitEl.classList.toggle('red', s2.color === 'red');

        handPreviewTextEl.textContent = currentCanonicalHand;

        setSelectedAction(null); // no default
        updateActionsForPosition();
        resetResultBox();
        resetHandState();
      }

      if (actionButtonsEl) {
        actionButtonsEl.addEventListener('click', (e) => {
          const btn = e.target.closest('.action-btn');
          if (!btn) return;
          if (btn.classList.contains('disabled') || btn.getAttribute('aria-disabled') === 'true') {
            return;
          }
          setSelectedAction(btn.dataset.action);
        });
      }

      /* Stats */
      const statsKey = 'pokerMyMind_preflopStats';

      function loadStats() {
        try {
          const raw = localStorage.getItem(statsKey);
          if (!raw) return { total: 0, good: 0, leaky: 0 };
          return JSON.parse(raw);
        } catch {
          return { total: 0, good: 0, leaky: 0 };
        }
      }

      function saveStats(stats) {
        try {
          localStorage.setItem(statsKey, JSON.stringify(stats));
        } catch {
          // ignore
        }
      }

      function updateStatsUI() {
        const stats = loadStats();
        statTotalEl.textContent = 'Decisions: ' + stats.total;
        statGoodEl.textContent = 'Good (A/B): ' + stats.good;
        statLeakyEl.textContent = 'Leaky (C–F): ' + stats.leaky;

        if (stats.total === 0) {
          reportGradeEl.textContent = '–';
          reportPercentEl.textContent = '0%';
          return;
        }
        const goodRate = stats.good / stats.total;
        let grade = 'D';
        if (goodRate >= 0.9) grade = 'A';
        else if (goodRate >= 0.75) grade = 'B';
        else if (goodRate >= 0.6) grade = 'C';

        reportGradeEl.textContent = grade;
        reportPercentEl.textContent = Math.round(goodRate * 100) + '%';
      }

      updateStatsUI();

      if (resetStatsBtn) {
        resetStatsBtn.addEventListener('click', () => {
          localStorage.removeItem(statsKey);
          updateStatsUI();
          resetResultBox();
        });
      }

      /* Auto-deal toggle */
      function renderAutoToggle() {
        autoDealToggleBtn.setAttribute('aria-pressed', autoDealEnabled ? 'true' : 'false');
        autoDealToggleBtn.classList.toggle('active', autoDealEnabled);
        autoDealToggleBtn.textContent = autoDealEnabled ? 'On' : 'Off';
      }
      renderAutoToggle();

      if (autoDealToggleBtn) {
        autoDealToggleBtn.addEventListener('click', () => {
          autoDealEnabled = !autoDealEnabled;
          renderAutoToggle();
          if (!autoDealEnabled) {
            clearAutoDealTimer();
            if (hasEvaluatedCurrent && !awaitingDeal) {
              awaitingDeal = true;
              setPrimaryToDeal();
            }
          }
        });
      }

      function startAutoDealCountdownIfNeeded(grade) {
        if (!autoDealEnabled || grade !== 'A') return;
        clearAutoDealTimer();
        const duration = 2000;
        const start = performance.now();
        primaryBtn.classList.add('timer-active');

        function step(now) {
          const progress = Math.min((now - start) / duration, 1);
          autoDealBarEl.style.width = progress * 100 + '%';
          if (progress < 1 && hasEvaluatedCurrent && autoDealEnabled && lastEvalGrade === 'A') {
            requestAnimationFrame(step);
          } else if (progress >= 1 && hasEvaluatedCurrent && autoDealEnabled && lastEvalGrade === 'A') {
            dealScenario();
            clearAutoDealTimer();
          }
        }

        autoDealTimeoutId = requestAnimationFrame(step);
      }

      /* Primary button */
      if (primaryBtn) {
        primaryBtn.addEventListener('click', () => {
          if (awaitingDeal) {
            dealScenario();
            return;
          }

          if (hasEvaluatedCurrent) {
            return; // already graded this spot
          }

          if (!selectedAction) {
            gradeLetterEl.textContent = '–';
            gradeLetterEl.classList.remove('grade-badge-good', 'grade-badge-bad');
            gradeContextEl.textContent = 'Pick an action first.';
            recommendationEl.textContent =
              'Choose Fold, Check, Call/Limp, or Raise before evaluating.';
            explanationEl.textContent =
              'Poker is about decisions. Lock in what you would actually do at the table, then hit Evaluate.';
            return;
          }

          const result = evaluatePreflopOpen(
            currentPosition,
            currentCanonicalHand,
            selectedAction
          );
          gradeLetterEl.textContent = result.grade;
          gradeLetterEl.classList.toggle('grade-badge-good', result.good);
          gradeLetterEl.classList.toggle('grade-badge-bad', !result.good);
          gradeContextEl.textContent = result.context;
          recommendationEl.textContent = 'Recommended: ' + result.recommended;
          explanationEl.textContent = result.explanation;

          hasEvaluatedCurrent = true;
          lastEvalGrade = result.grade;

          const stats = loadStats();
          stats.total += 1;
          if (result.grade === 'A' || result.grade === 'B') stats.good += 1;
          else stats.leaky += 1;
          saveStats(stats);
          updateStatsUI();

          if (autoDealEnabled && result.grade === 'A') {
            setPrimaryToEvaluate(); // stays as Evaluate while timer runs
            startAutoDealCountdownIfNeeded(result.grade);
          } else {
            awaitingDeal = true;
            setPrimaryToDeal();
          }
        });
      }

      /* ---------- Pot-odds helper ---------- */
      function approximateEquityFromOuts(outs) {
        // Rough rule of thumb with one card to come.
        return outs * 2.2;
      }

      const calculateOddsBtn = document.getElementById('calculateOddsBtn');
      if (calculateOddsBtn) {
        calculateOddsBtn.addEventListener('click', () => {
          const potSize = parseFloat(document.getElementById('potSize').value || '0');
          const betSize = parseFloat(document.getElementById('betSize').value || '0');
          const outs = parseInt(document.getElementById('outs').value || '0', 10);

          const summaryEl = document.getElementById('oddsSummary');
          const explanationElOdds = document.getElementById('oddsExplanation');

          if (betSize <= 0 || potSize < 0 || outs < 0) {
            summaryEl.textContent = '–';
            explanationElOdds.textContent =
              'Enter a pot size, a bet you are facing, and a non-negative number of outs to see the math.';
            return;
          }

          const totalPotIfCall = potSize + betSize + betSize;
          const potOdds = betSize / totalPotIfCall;
          const equityNeededPct = potOdds * 100;
          const equityFromOutsPct = approximateEquityFromOuts(outs);

          const isProfitable = equityFromOutsPct >= equityNeededPct;
          const verdict = isProfitable
            ? 'Calling is roughly +EV for this spot.'
            : 'Calling is roughly −EV here; folding is safer.';

          summaryEl.textContent = isProfitable ? 'Call OK' : 'Fold';
          explanationElOdds.innerHTML =
            'Pot odds require about ' +
            equityNeededPct.toFixed(1) +
            '% equity. ' +
            'Your draw with ' +
            outs +
            ' outs is worth roughly ' +
            equityFromOutsPct.toFixed(1) +
            '% equity.<br><br>' +
            verdict;
        });
      }

      // Start with a random hand
      dealScenario();
    });
  </script>
</body>
</html>
